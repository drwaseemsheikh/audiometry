<Window x:Class="Audiometry.View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:oxy="http://oxyplot.org/wpf"
        xmlns:wpfTool="clr-namespace:Xceed.Wpf.Toolkit;assembly=Xceed.Wpf.Toolkit"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:vm="clr-namespace:Audiometry.ViewModel"
        xmlns:pd="clr-namespace:Audiometry.ViewModel.PatientVM"
        xmlns:valid="clr-namespace:Audiometry.Validation"
        xmlns:speechVM="clr-namespace:Audiometry.ViewModel.SpeechVM"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
        xmlns:specialAM="clr-namespace:Audiometry.ViewModel.PureToneVM.SpecialTestsVM"
        xmlns:converter="clr-namespace:Audiometry.Converter"
        Title="Audiologic Profile" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen" Closing="Window_Closing">
    <Window.Resources>
        <converter:EnumBooleanConverter x:Key="enumBooleanConverter" />
        <converter:BooleanOrConverter x:Key="booleanOrConverter" />
        <converter:BooleanAndConverter x:Key="booleanAndConverter" />
        <converter:InverseBooleanConverter x:Key="inverseBooleanConverter" />
        <converter:EnumToCollectionConverter x:Key="enumToCollectionConverter" />
        <converter:StringToNullableDoubleConverter x:Key="stringToNullDblConverter" />
        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="5" />
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="5" />
        </Style>
        <Style TargetType="Button">
            <Setter Property="Margin" Value="5" />
            <Setter Property="Width" Value="80"></Setter>
            <Setter Property="Height" Value="30"></Setter>
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="MinWidth" Value="80" />
        </Style>
        <Style x:Key="PositiveNumberTextBoxStyle" TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip" Value="{Binding Path=(Validation.Errors)[0].ErrorContent, RelativeSource={RelativeSource Self}}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="AblbComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Margin" Value="4" />
            <Setter Property="Width" Value="40" />
            <Setter Property="Height" Value="24" />
        </Style>
        <Style TargetType="RadioButton">
            <Setter Property="Margin" Value="5" />
        </Style>
        <Style TargetType="DatePicker">
            <Setter Property="Margin" Value="5" />
        </Style>
        <Style TargetType="TextBlock">
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Foreground" Value="{StaticResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="HLTextBoxStyle" TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip"
                            Value="{Binding Path=(Validation.Errors)[0].ErrorContent, RelativeSource={RelativeSource Self}}" />
                </Trigger>
            </Style.Triggers>
            <Setter Property="Margin" Value="5" />
            <EventSetter Event="GotKeyboardFocus" Handler="TextBox_GotKeyboardFocus" />
        </Style>
        <DataTemplate x:Key="SymptomsListBoxItemTemplate" >
            <WrapPanel>
                <CheckBox Focusable="False" IsChecked="{Binding IsChecked}" VerticalAlignment="Center" />
                <ContentPresenter Content="{Binding Description, Mode=OneTime}"  Margin="2,0" />
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="DisordersListBoxItemTemplate" >
            <WrapPanel>
                <CheckBox Focusable="False" IsChecked="{Binding IsChecked}" VerticalAlignment="Center" />
                <ContentPresenter Content="{Binding Description, Mode=OneTime}"  Margin="2,0" />
            </WrapPanel>
        </DataTemplate>
        <DataTemplate x:Key="PtamTabTemplate">
            <AdornerDecorator>
                <Grid Name="PtamGrid">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Label Grid.Row="0" Grid.Column="1" Content="125 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="2" Content="250 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="3" Content="500 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="4" Content="1000 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="5" Content="2000 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="6" Content="3000 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="7" Content="4000 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="8" Content="6000 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="0" Grid.Column="9" Content="8000 Hz" HorizontalAlignment="Center" />
                    <Label Grid.Row="1" Grid.Column="0" Content="Right Ear" />
                    <Label Grid.Row="2" Grid.Column="0" Content="Left Ear" />
                    <TextBox Grid.Row="1" Grid.Column="1" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB125Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="2" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB250Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="3" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB500Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="4" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB1000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="5" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB2000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="6" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB3000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="7" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB4000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="8" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB6000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="1" Grid.Column="9" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.RtEarHLdB8000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="1" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB125Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="2" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB250Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="3" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB500Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="4" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB1000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="5" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB2000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="6" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB3000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="7" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB4000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="8" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB6000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                    <TextBox Grid.Row="2" Grid.Column="9" TextAlignment="Center" Style="{StaticResource HLTextBoxStyle}" LostFocus="HLTextBox_LostFocus">
                        <TextBox.Text>
                            <Binding UpdateSourceTrigger="LostFocus">
                                <Binding.RelativeSource>
                                    <RelativeSource Mode="TemplatedParent" />
                                </Binding.RelativeSource>
                                <Binding.Path>
                                    DataContext.PureToneData.LtEarHLdB8000Hz
                                </Binding.Path>
                                <Binding.ValidationRules>
                                    <valid:HearingLevelValidation />
                                </Binding.ValidationRules>
                            </Binding>
                        </TextBox.Text>
                    </TextBox>
                </Grid>
            </AdornerDecorator>
        </DataTemplate>
        <Style x:Key="SpeechTextBoxStyle" TargetType="TextBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="Width" Value="60" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip" Value="{Binding Path=(Validation.Errors)[0].ErrorContent, RelativeSource={RelativeSource Self}}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ImpedanceTextBoxStyle" TargetType="TextBox">
            <Setter Property="Margin" Value="5"></Setter>
            <Setter Property="Width" Value="100"></Setter>
            <Setter Property="HorizontalContentAlignment" Value="Center"></Setter>
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip" Value="{Binding Path=(Validation.Errors)[0].ErrorContent, RelativeSource={RelativeSource Self}}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ImpedanceComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Margin" Value="5"></Setter>
            <Setter Property="Width" Value="100"></Setter>
            <Setter Property="HorizontalContentAlignment" Value="Center"></Setter>
        </Style>
        <Style x:Key="CaloricTextBoxStyle" TargetType="TextBox">
            <Setter Property="Margin" Value="5"></Setter>
            <Setter Property="Width" Value="60"></Setter>
            <Setter Property="Height" Value="20"></Setter>
            <Setter Property="HorizontalContentAlignment" Value="Center"></Setter>
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip" Value="{Binding Path=(Validation.Errors)[0].ErrorContent, RelativeSource={RelativeSource Self}}" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <DockPanel ToolBar.OverflowMode="Never">
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_New" Click="NewBtn_Click" />
                <MenuItem Header="_Open" Click="OpenDbBtn_Click" />
                <MenuItem Header="_Save" Click="SaveDbBtn_Click" />
                <MenuItem Header="_Print" Click="PrintGuiBtn_Click" />
                <MenuItem Header="_Exit" Click="ExitApplication_Click" />
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Find" Click="OpenDbBtn_Click" />
                <MenuItem Header="_Delete" Click="DeleteDbBtn_Click" />
            </MenuItem>
        </Menu>
        <ToolBarTray DockPanel.Dock="Top">
            <ToolBar>
                <Button Content="New" Click="NewBtn_Click" />
                <Button Content="Open" Click="OpenDbBtn_Click"/>
                <Button Content="Save" Click="SaveDbBtn_Click" />
                <Button Content="Delete" Click="DeleteDbBtn_Click" />
                <Button Content="Print" Click="PrintGuiBtn_Click" />
            </ToolBar>
        </ToolBarTray>
        <TabControl x:Name="mainTabCtrl" DockPanel.Dock="Top">
            <TabItem Header="Patient">
                <ScrollViewer HorizontalScrollBarVisibility="Auto"  VerticalScrollBarVisibility="Auto" IsTabStop="True">
                    <AdornerDecorator>
                        <DockPanel>
                            <GroupBox DockPanel.Dock="Left" Header="Patient Information"
                                  BorderBrush="CornflowerBlue" Background="AliceBlue" Margin="5" Padding="5" Width="680" MinHeight="700">
                                <Canvas Name="PatientInfoCanvas" HorizontalAlignment="Stretch">
                                    <Grid Width="500">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Row="0" Grid.Column="0" Content="Account Number:" />
                                        <Label Grid.Row="1" Grid.Column="0" Content="First Name:" />
                                        <Label Grid.Row="2" Grid.Column="0" Content="Middle Name:" />
                                        <Label Grid.Row="3" Grid.Column="0" Content="Last Name:" />
                                        <Label Grid.Row="4" Grid.Column="0" Content="Title:" />
                                        <Label Grid.Row="5" Grid.Column="0" Content="Phone:" />
                                        <Label Grid.Row="6" Grid.Column="0" Content="Dependee's Name:" />
                                        <Label Grid.Row="7" Grid.Column="0" Content="Address:" />
                                        <Label Grid.Row="8" Grid.Column="0" Content="Date of birth:" />
                                        <Label Grid.Row="9" Grid.Column="0" Content="Sex:" />
                                        <Label Grid.Row="10" Grid.Column="0" Content="Profession:" />
                                        <Label Grid.Row="11" Grid.Column="0" Content="Hospital ID:" />

                                        <TextBox Grid.Row="0" Grid.Column="1" Margin="5,5,20,5" Style="{StaticResource PositiveNumberTextBoxStyle}" >
                                            <TextBox.Text>
                                                <Binding Path="AccNumber" UpdateSourceTrigger="PropertyChanged">
                                                    <Binding.ValidationRules>
                                                        <valid:PositiveNumberValidation />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </TextBox.Text>
                                        </TextBox>
                                        <TextBox Grid.Row="1" Grid.Column="1" Margin="5,5,20,5" Text="{Binding Path=FirstName, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="2" Grid.Column="1" Margin="5,5,20,5" Text="{Binding Path=MiddleName, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="3" Grid.Column="1" Margin="5,5,20,5" Text="{Binding Path=LastName, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="4" Grid.Column="1" Margin="5,5,20,5" Text="{Binding Path=Title, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="5" Grid.Column="1" Margin="5,5,20,5" Text="{Binding Path=Phone, UpdateSourceTrigger=PropertyChanged}" />
                                        <DockPanel Grid.Row="6" Grid.Column="1">
                                            <RadioButton Content="s/o" IsChecked="{Binding Path=DependeeRelation, Converter={StaticResource enumBooleanConverter}, ConverterParameter={x:Static pd:RelationType.Son} }" />
                                            <RadioButton Content="d/o" IsChecked= "{Binding Path=DependeeRelation, Converter={StaticResource enumBooleanConverter}, ConverterParameter={x:Static pd:RelationType.Daughter}}" />
                                            <RadioButton Content="w/o" IsChecked="{Binding Path=DependeeRelation, Converter={StaticResource enumBooleanConverter}, ConverterParameter={x:Static pd:RelationType.Wife}}"  />
                                            <TextBox Text="{Binding Path=DependeeName, UpdateSourceTrigger=PropertyChanged}" Margin="5,5,20,5" />
                                        </DockPanel>
                                        <TextBox Grid.Row="7" Grid.Column="1" Margin="5,5,20,5" TextWrapping="Wrap" AcceptsReturn="True" Text="{Binding Path=Address, UpdateSourceTrigger=PropertyChanged}" />
                                        <wpfTool:DateTimePicker Grid.Row="8" Grid.Column="1" DisplayDefaultValueOnEmptyText="True" 
                                            DefaultValue="{x:Static sys:DateTime.Now}" Margin="5,5,20,5"
                                            TimePickerVisibility="Hidden" Format="LongDate"
                                            TextAlignment="Left" Value="{Binding Path=DateOfBirth}" />
                                        <StackPanel Grid.Row="9" Grid.Column="1" Orientation="Horizontal" Margin="5,5,20,5">
                                            <RadioButton Content="Male" Margin="5,5,30,5" IsChecked="{Binding Path=Sex, Converter={StaticResource enumBooleanConverter}, ConverterParameter={x:Static pd:SexType.Male}}" />
                                            <RadioButton Content="Female" Margin="30,5,5,5" IsChecked="{Binding Path=Sex, Converter={StaticResource enumBooleanConverter}, ConverterParameter={x:Static pd:SexType.Female}}" />
                                        </StackPanel>
                                        <TextBox Grid.Row="10" Grid.Column="1" Text="{Binding Path=Profession, UpdateSourceTrigger=PropertyChanged}" Margin="5,5,20,5" />
                                        <TextBox Grid.Row="11" Grid.Column="1" Text="{Binding Path=HospitalID, UpdateSourceTrigger=PropertyChanged}" Margin="5,5,20,5" />
                                    </Grid>
                                </Canvas>
                            </GroupBox>
                            <GroupBox DockPanel.Dock="Top" Header="Exam Information"
                                  BorderBrush="CornflowerBlue" Background="AliceBlue" Margin="5" Padding="5" MinWidth="680" MinHeight="700" >
                                <Canvas Name="ExamInfoCanvas" HorizontalAlignment="Stretch">
                                    <Grid Width="500" HorizontalAlignment="Left">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" Content="Date of exam:" />
                                        <Label Grid.Row="2" Grid.Column="0" Content="Symptoms:" />
                                        <Label Grid.Row="3" Grid.Column="0" Content="Symptoms Remarks:" />
                                        <Label Grid.Row="4" Grid.Column="0" Content="Diagnosis:" />
                                        <Label Grid.Row="5" Grid.Column="0" Grid.RowSpan="3" Content="Diagnosis Remarks:" />
                                        <Label Grid.Row="6" Grid.Column="0" Grid.RowSpan="3" Content="Prescription:" />
                                        <StackPanel Grid.Row="0" Grid.Column="1" Grid.RowSpan="2">
                                            <wpfTool:DateTimePicker Name="dtExamDateTime" DisplayDefaultValueOnEmptyText="True" 
                                                                    DefaultValue="{x:Static sys:DateTime.Now}" Margin="5" TextAlignment="Left" 
                                                                    Value="{Binding Path=DateOfExam, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                                        </StackPanel>

                                        <ListBox Grid.Row="2" Grid.Column="1" Margin="5" HorizontalAlignment="Stretch" Name="lbSymptoms" 
                                                 VerticalAlignment="Stretch" Width="Auto" MinWidth="200" MinHeight="20" HorizontalContentAlignment="Left" 
                                                 ItemTemplate="{StaticResource SymptomsListBoxItemTemplate}" ItemsSource="{Binding Path=Symptoms}" 
                                                 VerticalContentAlignment="Top" Background="#FFDCEBEE" SelectionMode="Single">
                                        </ListBox>
                                        <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding SymptomsRemarks, UpdateSourceTrigger=PropertyChanged}" TextWrapping="Wrap" AcceptsReturn="True" />
                                        <ListBox Grid.Row="4" Grid.Column="1" Margin="5" HorizontalAlignment="Stretch" Name="lbDiagnosis" 
                                                 VerticalAlignment="Stretch" Width="Auto" MinWidth="200" MinHeight="20" HorizontalContentAlignment="Left" 
                                                 ItemTemplate="{StaticResource DisordersListBoxItemTemplate}" ItemsSource="{Binding Path=Diagnoses}" 
                                                 VerticalContentAlignment="Top" Background="#FFDCEBEE" SelectionMode="Single">
                                        </ListBox>
                                        <TextBox Grid.Row="5" Grid.Column="1" TextWrapping="Wrap" AcceptsReturn="True" 
                                                 Text="{Binding DiagnosisRemarks, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="6" Grid.Column="1" TextWrapping="Wrap" AcceptsReturn="True" 
                                                 Text="{Binding Path=Prescription, UpdateSourceTrigger=PropertyChanged}" />
                                    </Grid>
                                </Canvas>
                            </GroupBox>
                        </DockPanel>
                    </AdornerDecorator>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="Pure Tone">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" IsTabStop="True">
                    <AdornerDecorator>
                        <DockPanel>
                            <GroupBox DockPanel.Dock="Left" Name="PureToneGrpBox" Header="Pure Tone Audiometry" BorderBrush="CornflowerBlue" Background="AliceBlue"
                                      Margin="5" Padding="5" Width="790" >
                                <DockPanel>
                                    <StackPanel Orientation="Vertical" DockPanel.Dock="Top">
                                        <Canvas Name="PureToneAMCanvas" Height="170" HorizontalAlignment="Stretch">
                                            <StackPanel Orientation="Horizontal" Margin="5" HorizontalAlignment="Left">
                                                <CheckBox x:Name="isPureToneTestConducted" Content="Test conducted" Margin="0,5,20,5"
                                                      IsChecked="{Binding IsPureToneTestConducted}" />
                                                <wpfTool:DateTimePicker Name="dtPureToneDateTime" DisplayDefaultValueOnEmptyText="True" 
                                                                    DefaultValue="{x:Static sys:DateTime.Now}" Margin="10,5,5,5" Width="300" TextAlignment="Left"
                                                                    Value="{Binding ElementName=dtExamDateTime, Path=Value}"                                                                    
                                                                    IsEnabled="{Binding ElementName=isPureToneTestConducted, Path=IsChecked}" />
                                            </StackPanel>
                                            <TabControl x:Name="ptamTabCtrl" DockPanel.Dock="Top" IsEnabled="{Binding ElementName=isPureToneTestConducted, Path=IsChecked}"
                                                ItemsSource="{Binding PureToneAMTabs}" SelectedIndex="0" Height="114" Canvas.Top="50" Width="770"
                                                        ContentTemplate="{StaticResource PtamTabTemplate}" IsSynchronizedWithCurrentItem="True" >
                                                <TabControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding TabTitle}"/>
                                                    </DataTemplate>
                                                </TabControl.ItemTemplate>
                                            </TabControl>
                                        </Canvas>
                                    </StackPanel>
                                    <oxy:PlotView Name="AudiogramPlot" DockPanel.Dock="Top" Margin="10" Height="510" Width="750" 
                                                  HorizontalAlignment="Left" VerticalAlignment="Top" IsEnabled="{Binding ElementName=isPureToneTestConducted, Path=IsChecked}" 
                                                  Model="{Binding ACMskTabVM.PureToneData.AudiogramPlot.PlotModel}" />
                                    <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Center" Margin="5" >
                                        <CheckBox Content="Right Ear">
                                            <CheckBox.IsChecked>
                                                <MultiBinding Converter="{StaticResource booleanAndConverter}" ConverterParameter="7">
                                                    <Binding Path="ACMskTabVM.PureToneData.ShowRtEarPlot" />
                                                    <Binding Path="ACUmskTabVM.PureToneData.ShowRtEarPlot" />
                                                    <Binding Path="BCMskTabVM.PureToneData.ShowRtEarPlot" />
                                                    <Binding Path="BCUmskTabVM.PureToneData.ShowRtEarPlot" />
                                                    <Binding Path="ACAidedTabVM.PureToneData.ShowRtEarPlot" />
                                                    <Binding Path="LoudnessTabVM.PureToneData.ShowRtEarPlot" />
                                                    <Binding Path="SoundFieldTabVM.PureToneData.ShowRtEarPlot" />
                                                </MultiBinding>
                                            </CheckBox.IsChecked>
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="ACMskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="ACUmskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="BCMskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="BCUmskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="ACAidedTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="LoudnessTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="SoundFieldTabVM.PureToneData.HasRtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="Left Ear">
                                            <CheckBox.IsChecked>
                                                <MultiBinding Converter="{StaticResource booleanAndConverter}" ConverterParameter="7">
                                                    <Binding Path="ACMskTabVM.PureToneData.ShowLtEarPlot" />
                                                    <Binding Path="ACUmskTabVM.PureToneData.ShowLtEarPlot" />
                                                    <Binding Path="BCMskTabVM.PureToneData.ShowLtEarPlot" />
                                                    <Binding Path="BCUmskTabVM.PureToneData.ShowLtEarPlot" />
                                                    <Binding Path="ACAidedTabVM.PureToneData.ShowLtEarPlot" />
                                                    <Binding Path="LoudnessTabVM.PureToneData.ShowLtEarPlot" />
                                                    <Binding Path="SoundFieldTabVM.PureToneData.ShowLtEarPlot" />
                                                </MultiBinding>
                                            </CheckBox.IsChecked>
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="ACMskTabVM.PureToneData.HasLtEarValidData" />
                                                    <Binding Path="ACUmskTabVM.PureToneData.HasLtEarValidData" />
                                                    <Binding Path="BCMskTabVM.PureToneData.HasLtEarValidData" />
                                                    <Binding Path="BCUmskTabVM.PureToneData.HasLtEarValidData" />
                                                    <Binding Path="ACAidedTabVM.PureToneData.HasLtEarValidData" />
                                                    <Binding Path="LoudnessTabVM.PureToneData.HasLtEarValidData" />
                                                    <Binding Path="SoundFieldTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="AC Msk"
                                                          IsChecked="{Binding ACMskTabVM.PureToneData.ShowPlot}">
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="ACMskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="ACMskTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="AC/Umsk"
                                                          IsChecked="{Binding ACUmskTabVM.PureToneData.ShowPlot}">
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="ACUmskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="ACUmskTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="BC Msk"
                                                          IsChecked="{Binding BCMskTabVM.PureToneData.ShowPlot}">
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="BCMskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="BCMskTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="BC/Umsk"
                                                          IsChecked="{Binding BCUmskTabVM.PureToneData.ShowPlot}">
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="BCUmskTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="BCUmskTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="AC Aided"
                                                          IsChecked="{Binding ACAidedTabVM.PureToneData.ShowPlot}">
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="ACAidedTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="ACAidedTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="Loudness"
                                                          IsChecked="{Binding LoudnessTabVM.PureToneData.ShowPlot}">
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="LoudnessTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="LoudnessTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                        <CheckBox Content="Sound Field"
                                                          IsChecked="{Binding SoundFieldTabVM.PureToneData.ShowPlot}">
                                            <CheckBox.IsEnabled>
                                                <MultiBinding Converter="{StaticResource booleanOrConverter}">
                                                    <Binding Path="SoundFieldTabVM.PureToneData.HasRtEarValidData" />
                                                    <Binding Path="SoundFieldTabVM.PureToneData.HasLtEarValidData" />
                                                </MultiBinding>
                                            </CheckBox.IsEnabled>
                                        </CheckBox>
                                    </StackPanel>
                                    <Grid Height="120">
                                        <Canvas Name="HearingDisabilityCanvas" HorizontalAlignment="Stretch">
                                            <Grid Margin="10" IsEnabled="{Binding ElementName=isPureToneTestConducted, Path=IsChecked}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Separator Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6"/>
                                                <Label Grid.Row="1" Grid.Column="0" Content="Average Speech Perception in Right Ear (A) = &#xA; ACUmsk(HL[500]+HL[1000]+HL[2000]+HL[3000])/4" />
                                                <TextBox Grid.Row="1" Grid.Column="1" IsReadOnly="True" Style="{StaticResource CaloricTextBoxStyle}"
                                                     VerticalAlignment="Center" Grid.RowSpan="2">
                                                    <TextBox.Text>
                                                        <Binding Path="ACUmskTabVM.PureToneData.AvgSpPerRtEar">
                                                            <Binding.ValidationRules>
                                                                <valid:IntensityValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:FormattedStringToNullableDoubleConverter/>
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="1" Grid.Column="2" Content="dB" VerticalAlignment="Center" Grid.RowSpan="2" />
                                                <Label Grid.Row="3" Grid.Column="0" Content="Impairment in Right Ear = (A-25) x 1.5" />
                                                <TextBox Grid.Row="3" Grid.Column="1" IsReadOnly="True" Style="{StaticResource CaloricTextBoxStyle}">
                                                    <TextBox.Text>
                                                        <Binding Path="ACUmskTabVM.PureToneData.ImpairRtEar">
                                                            <Binding.ValidationRules>
                                                                <valid:PercentageValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:FormattedStringToNullableDoubleConverter/>
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="3" Grid.Column="2" Content="%" />
                                                <Label Grid.Row="1" Grid.Column="3" Content="Average Speech Perception in Left Ear (A) = &#xA; ACUmsk(HL[500]+HL[1000]+HL[2000]+HL[3000])/4" />
                                                <TextBox Grid.Row="1" Grid.Column="4" IsReadOnly="True" Style="{StaticResource CaloricTextBoxStyle}"
                                                     VerticalAlignment="Center" Grid.RowSpan="2">
                                                    <TextBox.Text>
                                                        <Binding Path="ACUmskTabVM.PureToneData.AvgSpPerLtEar">
                                                            <Binding.ValidationRules>
                                                                <valid:IntensityValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:FormattedStringToNullableDoubleConverter/>
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="1" Grid.Column="5" Content="dB" VerticalAlignment="Center" Grid.RowSpan="2" />
                                                <Label Grid.Row="3" Grid.Column="3" Content="Impairment in Left Ear = (A-25) x 1.5" />
                                                <TextBox Grid.Row="3" Grid.Column="4" IsReadOnly="True" Style="{StaticResource CaloricTextBoxStyle}">
                                                    <TextBox.Text>
                                                        <Binding Path="ACUmskTabVM.PureToneData.ImpairLtEar">
                                                            <Binding.ValidationRules>
                                                                <valid:PercentageValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:FormattedStringToNullableDoubleConverter/>
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="3" Grid.Column="5" Content="%" />
                                                <Label Grid.Row="4" Grid.Column="0" Content="Disability = ((Better Ear % x 5) + Worse Ear %)/6 " />
                                                <TextBox Grid.Row="4" Grid.Column="1" IsReadOnly="True" Style="{StaticResource CaloricTextBoxStyle}">
                                                    <TextBox.Text>
                                                        <Binding Path="ACUmskTabVM.PureToneData.Disability">
                                                            <Binding.ValidationRules>
                                                                <valid:PercentageValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:FormattedStringToNullableDoubleConverter/>
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="4" Grid.Column="2" Content="%" />
                                                <Separator Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="6"/>
                                            </Grid>
                                        </Canvas>
                                    </Grid>
                                </DockPanel>
                            </GroupBox>
                            <GroupBox Name="SpecialTestsGrpBox" Header="Special Tests" DockPanel.Dock="Top"
                                      BorderBrush="CornflowerBlue" Background="AliceBlue" Margin="5"  Padding="5" Height="350" MinWidth="620">
                                <Canvas Name="SpecialTestsCanvas" HorizontalAlignment="Stretch">
                                    <StackPanel Orientation="Horizontal" Margin="5" HorizontalAlignment="Left">
                                        <CheckBox x:Name="isSpecialTestConducted" Content="Test conducted" Margin="0,5,20,5"
                                                      IsChecked="{Binding IsSpecialTestConducted}" />
                                        <wpfTool:DateTimePicker Name="dtSpecialTestsDateTime" DisplayDefaultValueOnEmptyText="True"
                                                                    DefaultValue="{x:Static sys:DateTime.Now}" Margin="10,5,5,5" Width="300" TextAlignment="Left"
                                                                    Value="{Binding ElementName=dtExamDateTime, Path=Value}"
                                                                    IsEnabled="{Binding ElementName=isSpecialTestConducted, Path=IsChecked}" />
                                    </StackPanel>
                                    <TabControl x:Name="specialTestsTabCtrl" IsEnabled="{Binding ElementName=isSpecialTestConducted, 
                                            Path=IsChecked}" Canvas.Top="50">
                                        <TabItem Header="ABLB">
                                            <DockPanel>
                                                <Grid DockPanel.Dock="Top" Name="AblbGrid">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Label Grid.Row="0" Grid.Column="0" Content="Right Ear (dB)"/>
                                                    <ComboBox  Grid.Row="0" Grid.Column="1" Name="RightEar0" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar0, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="2" Name="RightEar1"  Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar1, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="3" Name="RightEar2" Margin="4,4,4,5" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar2, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="4" Name="RightEar3" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar3, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="5" Name="RightEar4" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar4, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="6" Name="RightEar5" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar5, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="7" Name="RightEar6" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar6, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="8" Name="RightEar7" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar7, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="9" Name="RightEar8" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar8, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="0" Grid.Column="10" Name="RightEar9" Margin="4,4,4,5"
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding RightEar9, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <Label Grid.Row="1" Grid.Column="0" Content="Left Ear (dB)" Margin="4,0" />
                                                    <ComboBox  Grid.Row="1" Grid.Column="1" Name="LeftEar0" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar0, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="2" Name="LeftEar1" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar1, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="3" Name="LeftEar2" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar2, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="4" Name="LeftEar3" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar3, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="5" Name="LeftEar4" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar4, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="6" Name="LeftEar5" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar5, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="7" Name="LeftEar6" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar6, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="8" Name="LeftEar7" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar7, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="9" Name="LeftEar8" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar8, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                    <ComboBox  Grid.Row="1" Grid.Column="10" Name="LeftEar9" 
                                                           ItemsSource="{x:Static specialAM:AblbTabVM.IntensitiesdB}" 
                                                           SelectedItem="{Binding LeftEar9, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay, 
                                                           Converter={StaticResource stringToNullDblConverter}}">
                                                        <ComboBox.Style>
                                                            <Style TargetType="{x:Type ComboBox}">
                                                                <Setter Property="Margin" Value="4" />
                                                                <Setter Property="MinWidth" Value="40" />
                                                                <Setter Property="Height" Value="24" />
                                                            </Style>
                                                        </ComboBox.Style>
                                                    </ComboBox>
                                                </Grid>
                                                <oxy:PlotView Name="AblbPlot" DockPanel.Dock="Top" Height="180" Width="600" Model="{Binding AblbPlotModel}" />
                                            </DockPanel>
                                        </TabItem>
                                        <TabItem Header="SISI">
                                            <Grid Margin="10" Name="SisiGrid">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Label Grid.Row="0" Grid.Column="0" Content="Right Ear Score" />
                                                <TextBox Grid.Row="0" Grid.Column="1" Width="40">
                                                    <TextBox.Text>
                                                        <Binding Path="SisiRtEar" UpdateSourceTrigger="PropertyChanged">
                                                            <Binding.ValidationRules>
                                                                <valid:PercentageValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:StringToNullableDoubleConverter />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="0" Grid.Column="2" Content="%" />
                                                <Label Grid.Row="1" Grid.Column="0" Content="Left Ear Score" />
                                                <TextBox Grid.Row="1" Grid.Column="1" Width="40">
                                                    <TextBox.Text>
                                                        <Binding Path="SisiLtEar" UpdateSourceTrigger="PropertyChanged">
                                                            <Binding.ValidationRules>
                                                                <valid:PercentageValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:StringToNullableDoubleConverter />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="1" Grid.Column="2" Content="%" />
                                            </Grid>
                                        </TabItem>
                                        <TabItem Header="Tone Decay">
                                            <Grid Margin="10" Name="ToneDecayGrid">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Label Grid.Row="0" Grid.Column="0" Content="Right Ear" />
                                                <TextBox Grid.Row="0" Grid.Column="1" Width="40">
                                                    <TextBox.Text>
                                                        <Binding Path="TdRtEar" UpdateSourceTrigger="PropertyChanged">
                                                            <Binding.ValidationRules>
                                                                <valid:IntensityValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:StringToNullableDoubleConverter />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="0" Grid.Column="2" Content="dB" />
                                                <Label Grid.Row="1" Grid.Column="0" Content="Left Ear" />
                                                <TextBox Grid.Row="1" Grid.Column="1" Width="40">
                                                    <TextBox.Text>
                                                        <Binding Path="TdLtEar" UpdateSourceTrigger="PropertyChanged">
                                                            <Binding.ValidationRules>
                                                                <valid:IntensityValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:StringToNullableDoubleConverter />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                </TextBox>
                                                <Label Grid.Row="1" Grid.Column="2" Content="dB" />
                                            </Grid>
                                        </TabItem>
                                        <TabItem Header="Stenger">
                                            <Grid Margin="10" Name="StengerGrid">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Label Grid.Row="0" Grid.Column="0" Content="Right Ear" />
                                                <ComboBox Grid.Row="0" Grid.Column="1" Width="40"
                                                              ItemsSource="{Binding Path=StgrRtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                              SelectedValuePath="Value"
                                                              DisplayMemberPath="Description"
                                                              SelectedValue="{Binding Path=StgrRtEar}"/>
                                                <Label Grid.Row="1" Grid.Column="0" Content="Left Ear" />
                                                <ComboBox Grid.Row="1" Grid.Column="1" Width="40" 
                                                              ItemsSource="{Binding Path=StgrLtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                              SelectedValuePath="Value"
                                                              DisplayMemberPath="Description"
                                                              SelectedValue="{Binding Path=StgrLtEar}"/>
                                            </Grid>
                                        </TabItem>
                                    </TabControl>
                                </Canvas>
                            </GroupBox>
                            <GroupBox Name="TuningForkTestGrpBox" Header="Tuning Fork Tests" DockPanel.Dock="Top"
                                      BorderBrush="CornflowerBlue" Background="AliceBlue" Margin="5" Padding="5" >
                                <Canvas Name="TuningForkTestsCanvas" HorizontalAlignment="Stretch">
                                    <DockPanel>
                                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Left" Margin="5">
                                            <CheckBox x:Name="isTuningForkTestConducted" Content="Test conducted" Margin="0,5,20,5" 
                                                      IsChecked="{Binding TuningForkVM.IsTestConducted}" />
                                            <wpfTool:DateTimePicker Name="dtTuningForkTestsDateTime" DisplayDefaultValueOnEmptyText="True" 
                                                                DefaultValue="{x:Static sys:DateTime.Now}" Margin="10,5,5,5" Width="300" TextAlignment="Left"
                                                                Value="{Binding ElementName=dtExamDateTime, Path=Value}"
                                                                IsEnabled="{Binding ElementName=isTuningForkTestConducted, Path=IsChecked}" />
                                        </StackPanel>
                                        <Grid DockPanel.Dock="Right" HorizontalAlignment="Left" IsEnabled="{Binding ElementName=isTuningForkTestConducted, Path=IsChecked}" Margin="10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Row="0" Grid.Column="2" Content="Right Ear" HorizontalAlignment="Center" />
                                            <Label Grid.Row="0" Grid.Column="3" Content="Left Ear" HorizontalAlignment="Center" />
                                            <Separator Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <Label Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Content="Weber (512 Hz)" />
                                            <Separator Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <Label Grid.Row="4" Grid.Column="0" Grid.RowSpan="3" VerticalAlignment="Center" Content="Rinne" />
                                            <Label Grid.Row="4" Grid.Column="1" Content="256 Hz" />
                                            <Label Grid.Row="5" Grid.Column="1" Content="512 Hz" />
                                            <Label Grid.Row="6" Grid.Column="1" Content="1024 Hz" />
                                            <Separator Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <Label Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="2" Content="Schwabach" />
                                            <Label Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="2" Content="Absolute Bone Conduction" />
                                            <Label Grid.Row="10" Grid.Column="0" Grid.ColumnSpan="2" Content="Stenger" />
                                            <Label Grid.Row="11" Grid.Column="0" Grid.ColumnSpan="2" Content="Teal" />
                                            <Label Grid.Row="12" Grid.Column="0" Grid.ColumnSpan="2" Content="Gelle" />
                                            <Separator Grid.Row="13" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <ComboBox Grid.Row="2" Grid.Column="2"
                                                      ItemsSource="{Binding Path=TuningForkVM.Wbr512RtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Wbr512RtEar}" />
                                            <ComboBox Grid.Row="2" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.Wbr512LtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Wbr512LtEar}" />
                                            <ComboBox Grid.Row="4" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.Rn256RtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Rn256RtEar}" />
                                            <ComboBox Grid.Row="4" Grid.Column="4" 
                                                      ItemsSource="{Binding Path=TuningForkVM.Rn256LtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Rn256LtEar}" />
                                            <ComboBox Grid.Row="5" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.Rn512RtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Rn512RtEar}" />
                                            <ComboBox Grid.Row="5" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.Rn512LtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Rn512LtEar}" />
                                            <ComboBox Grid.Row="6" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.Rn1024RtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Rn1024RtEar}" />
                                            <ComboBox Grid.Row="6" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.Rn1024LtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.Rn1024LtEar}" />
                                            <ComboBox Grid.Row="8" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.SwbRtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.SwbRtEar}" />
                                            <ComboBox Grid.Row="8" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.SwbLtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.SwbLtEar}" />
                                            <ComboBox Grid.Row="9" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.AbcRtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.AbcRtEar}" />
                                            <ComboBox Grid.Row="9" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.AbcLtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.AbcLtEar}" />
                                            <ComboBox Grid.Row="10" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.StgRtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.StgRtEar}" />
                                            <ComboBox Grid.Row="10" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.StgLtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.StgLtEar}" />
                                            <ComboBox Grid.Row="11" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.TlRtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.TlRtEar}" />
                                            <ComboBox Grid.Row="11" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.TlLtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.TlLtEar}" />
                                            <ComboBox Grid.Row="12" Grid.Column="2" 
                                                      ItemsSource="{Binding Path=TuningForkVM.GlRtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.GlRtEar}" />
                                            <ComboBox Grid.Row="12" Grid.Column="3" 
                                                      ItemsSource="{Binding Path=TuningForkVM.GlLtEar, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}" 
                                                      SelectedValuePath="Value"
                                                      DisplayMemberPath="Description"
                                                      SelectedValue="{Binding Path=TuningForkVM.GlLtEar}" />
                                        </Grid>
                                    </DockPanel>
                                </Canvas>
                            </GroupBox>
                        </DockPanel>
                    </AdornerDecorator>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="Speech">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" IsTabStop="True">
                    <AdornerDecorator>
                        <GroupBox Name="SpeechGrpBox" Header="Speech Audiometry" Margin="5" Padding="5"
                                      BorderBrush="CornflowerBlue" Background="AliceBlue" >
                            <DockPanel>
                                <Canvas Name="SpeechAudiometryCanvas" HorizontalAlignment="Stretch" DockPanel.Dock="Top">
                                    <DockPanel>
                                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Left" Margin="5">
                                            <CheckBox x:Name="isSpeechConducted" Content="Test conducted" Margin="0,5,20,5"
                                                  IsChecked="{Binding IsSpeechTestConducted}" />
                                            <wpfTool:DateTimePicker Name="dtSpeechDateTime" DisplayDefaultValueOnEmptyText="True"
                                                                DefaultValue="{x:Static sys:DateTime.Now}" Margin="10,5,5,5" Width="300" TextAlignment="Left"
                                                                Value="{Binding ElementName=dtExamDateTime, Path=Value}"
                                                                IsEnabled="{Binding ElementName=isSpeechConducted, Path=IsChecked}" />
                                        </StackPanel>
                                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Left" IsEnabled="{Binding ElementName=isSpeechConducted, Path=IsChecked}">
                                            <RadioButton Name="RtEarSpeechTest" Content="Right Ear" IsChecked="{Binding IsRtEarTest}" />
                                            <RadioButton Name="LtEarSpeechTest" Content="Left Ear" IsChecked="{Binding IsLtEarTest}" />
                                            <RadioButton Name="BilateralSpeechTest" Content="Bilateral" IsChecked="{Binding IsBilateralTest}" />
                                        </StackPanel>
                                        <Grid DockPanel.Dock="Top" IsEnabled="{Binding ElementName=isSpeechConducted, Path=IsChecked}" Margin="10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Row="0" Grid.Column="0" Content="Intensity (dB)" />
                                            <TextBox Grid.Row="0" Grid.Column="1" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity0dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="2" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity1dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="3" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity2dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="4" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity3dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="5" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity4dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="6" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity5dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="7" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity6dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="8" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity7dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="9" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity8dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="0" Grid.Column="10" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Intensity9dB" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:IntensityValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <Label Grid.Row="1" Grid.Column="0" Content="Score (%)" />
                                            <TextBox Grid.Row="1" Grid.Column="1" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score0" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="2" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score1" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="3" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score2" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="4" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score3" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="5" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score4" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="6" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score5" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="7" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score6" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="8" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score7" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="9" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score8" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="1" Grid.Column="10" Style="{StaticResource SpeechTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="Score9" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:PercentageValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter />
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                        </Grid>
                                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Left" IsEnabled="{Binding ElementName=isSpeechConducted, Path=IsChecked}">
                                            <Grid Margin="10">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Label Grid.Row="0" Grid.Column="0" Content="SRT (dB)" Width="80" HorizontalContentAlignment="Center" />
                                                <Label Grid.Row="0" Grid.Column="1" Content="SD Score (%)" Width="80" HorizontalContentAlignment="Center" />
                                                <Label Grid.Row="0" Grid.Column="2" Content="SD Intensity (dB)" Width="100" HorizontalContentAlignment="Center" />
                                                <TextBox Grid.Row="1" Grid.Column="0" IsReadOnly="True" Style="{StaticResource SpeechTextBoxStyle}" Margin="10,5">
                                                    <TextBox.Text>
                                                        <Binding Path="SRTdB">
                                                            <Binding.ValidationRules>
                                                                <valid:IntensityValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:StringToNullableDoubleConverter />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="GotFocus">
                                                            <i:InvokeCommandAction Command="{Binding SrtSdCommand}" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </TextBox>
                                                <TextBox Grid.Row="1" Grid.Column="1" IsReadOnly="True" Style="{StaticResource SpeechTextBoxStyle}">
                                                    <TextBox.Text>
                                                        <Binding Path="SDScore">
                                                            <Binding.ValidationRules>
                                                                <valid:PercentageValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:StringToNullableDoubleConverter />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="GotFocus">
                                                            <i:InvokeCommandAction Command="{Binding SrtSdCommand}" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </TextBox>
                                                <TextBox Grid.Row="1" Grid.Column="2" IsReadOnly="True" Style="{StaticResource SpeechTextBoxStyle}">
                                                    <TextBox.Text>
                                                        <Binding Path="SDIntensitydB">
                                                            <Binding.ValidationRules>
                                                                <valid:IntensityValidation />
                                                            </Binding.ValidationRules>
                                                            <Binding.Converter>
                                                                <converter:StringToNullableDoubleConverter />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </TextBox.Text>
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="GotFocus">
                                                            <i:InvokeCommandAction Command="{Binding SrtSdCommand}" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </TextBox>
                                            </Grid>
                                        </StackPanel>
                                    </DockPanel>
                                </Canvas>
                                <oxy:PlotView Name="SpeechAudiometryPlot" DockPanel.Dock="Top" HorizontalAlignment="Left" VerticalAlignment="Top" 
                                              Margin="10,220,0,10" Width="800" Height="500" Model="{Binding SpeechPlotModel}"
                                              IsEnabled="{Binding ElementName=isSpeechConducted, Path=IsChecked}"/>
                            </DockPanel>
                        </GroupBox>
                    </AdornerDecorator>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="Impedance">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" IsTabStop="True">
                    <AdornerDecorator>
                        <GroupBox Name="ImpedanceGrpBox" Header="Impedance Audiometry" Margin="5" Padding="5"
                                      BorderBrush="CornflowerBlue" Background="AliceBlue">
                            <DockPanel>
                                <Canvas Name="ImpedanceCanvas" HorizontalAlignment="Stretch" DockPanel.Dock="Top">
                                    <DockPanel>
                                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" HorizontalAlignment="Left" Margin="5">
                                            <CheckBox x:Name="isImpedanceTestConducted" Content="Test conducted" Margin="0,5,20,5"
                                                  IsChecked="{Binding IsImpedanceTestConducted}" />
                                            <wpfTool:DateTimePicker Name="dtImpedanceDateTime" DisplayDefaultValueOnEmptyText="True"
                                                                DefaultValue="{x:Static sys:DateTime.Now}" Margin="10,5,5,5" Width="300" TextAlignment="Left"
                                                                Value="{Binding ElementName=dtExamDateTime, Path=Value}"
                                                                IsEnabled="{Binding ElementName=isImpedanceTestConducted, Path=IsChecked}" />
                                        </StackPanel>
                                        <Grid DockPanel.Dock="Top" IsEnabled="{Binding ElementName=isImpedanceTestConducted, Path=IsChecked}" Margin="10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Row="0" Grid.Column="2" HorizontalAlignment="Center" Content="Right Ear" />
                                            <Label Grid.Row="0" Grid.Column="3" HorizontalAlignment="Center" Content="Left Ear" />
                                            <Separator Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <TextBlock Grid.Row="6" Grid.Column="0" Margin="4">Compliance (cm<Run FontSize="10" BaselineAlignment="Superscript">3</Run>)</TextBlock>
                                            <Label Grid.Row="2" Grid.Column="1" Content="-400 daPa" />
                                            <Label Grid.Row="3" Grid.Column="1" Content="-300 daPa" />
                                            <Label Grid.Row="4" Grid.Column="1" Content="-200 daPa" />
                                            <Label Grid.Row="5" Grid.Column="1" Content="-100 daPa" />
                                            <Label Grid.Row="6" Grid.Column="1" Content="0 daPa" />
                                            <Label Grid.Row="7" Grid.Column="1" Content="100 daPa" />
                                            <Label Grid.Row="8" Grid.Column="1" Content="200 daPa" />
                                            <Label Grid.Row="9" Grid.Column="1" Content="300 daPa" />
                                            <Label Grid.Row="10" Grid.Column="1" Content="400 daPa" />
                                            <Separator Grid.Row="11" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <Label Grid.Row="12" Grid.Column="0" Content="Peak Pressure (daPa)" />
                                            <Separator Grid.Row="13" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <TextBlock Grid.Row="14" Grid.Column="0" Margin="4">Ear Canal Volume (cm<Run FontSize="10" BaselineAlignment="Superscript">3</Run>)</TextBlock>
                                            <Label Grid.Row="15" Grid.Column="0" Content="Curve Type" />
                                            <Separator Grid.Row="16" Grid.Column="0" Grid.ColumnSpan="4" />
                                            <Label Grid.Row="17" Grid.Column="0" Grid.RowSpan="4" VerticalAlignment="Center" Content="Acoustic Reflex" />
                                            <Label Grid.Row="17" Grid.Column="1" Content="500 Hz" />
                                            <Label Grid.Row="18" Grid.Column="1" Content="1000 Hz" />
                                            <Label Grid.Row="19" Grid.Column="1" Content="2000 Hz" />
                                            <Label Grid.Row="20" Grid.Column="1" Content="4000 Hz" />
                                            <Separator Grid.Row="21" Grid.Column="0" Grid.ColumnSpan="4" />

                                            <TextBox Grid.Row="2" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarComplianceNeg400daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="2" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarComplianceNeg400daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarComplianceNeg300daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="3" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarComplianceNeg300daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="4" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarComplianceNeg200daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="4" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarComplianceNeg200daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="5" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarComplianceNeg100daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="5" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarComplianceNeg100daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="6" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarCompliance0daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="6" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarCompliance0daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="7" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarCompliance100daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="7" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarCompliance100daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="8" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarCompliance200daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="8" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarCompliance200daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="9" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarCompliance300daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="9" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarCompliance300daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="10" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarCompliance400daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="10" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarCompliance400daPa" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="12" Grid.Column="2" IsReadOnly="True" 
                                                 Style="{StaticResource ImpedanceTextBoxStyle}" Text="{Binding RtEarPeakPressure, UpdateSourceTrigger=LostFocus}">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="GotFocus">
                                                        <i:InvokeCommandAction Command="{Binding PeakPressureCommand}" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                            </TextBox>
                                            <TextBox Grid.Row="12" Grid.Column="3" IsReadOnly="True" 
                                                 Style="{StaticResource ImpedanceTextBoxStyle}" Text="{Binding LtEarPeakPressure, UpdateSourceTrigger=LostFocus}">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="GotFocus">
                                                        <i:InvokeCommandAction Command="{Binding PeakPressureCommand}" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                            </TextBox>
                                            <TextBox Grid.Row="14" Grid.Column="2" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="RtEarCanalVolume" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <TextBox Grid.Row="14" Grid.Column="3" Style="{StaticResource ImpedanceTextBoxStyle}">
                                                <TextBox.Text>
                                                    <Binding Path="LtEarCanalVolume" UpdateSourceTrigger="LostFocus">
                                                        <Binding.ValidationRules>
                                                            <valid:ComplianceValidation />
                                                        </Binding.ValidationRules>
                                                        <Binding.Converter>
                                                            <converter:StringToNullableDoubleConverter/>
                                                        </Binding.Converter>
                                                    </Binding>
                                                </TextBox.Text>
                                            </TextBox>
                                            <ComboBox Grid.Row="15" Grid.Column="2" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=RtEarCurveType, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=RtEarCurveType}" />
                                            <ComboBox Grid.Row="15" Grid.Column="3" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=LtEarCurveType, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=LtEarCurveType}" />
                                            <ComboBox Grid.Row="17" Grid.Column="2" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=RtEarAcousticReflex500Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=RtEarAcousticReflex500Hz}" />
                                            <ComboBox Grid.Row="17" Grid.Column="3" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=LtEarAcousticReflex500Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=LtEarAcousticReflex500Hz}" />
                                            <ComboBox Grid.Row="18" Grid.Column="2" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=RtEarAcousticReflex1000Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=RtEarAcousticReflex1000Hz}" />
                                            <ComboBox Grid.Row="18" Grid.Column="3" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=LtEarAcousticReflex1000Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=LtEarAcousticReflex1000Hz}" />
                                            <ComboBox Grid.Row="19" Grid.Column="2" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=RtEarAcousticReflex2000Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=RtEarAcousticReflex2000Hz}" />
                                            <ComboBox Grid.Row="19" Grid.Column="3" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=LtEarAcousticReflex2000Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=LtEarAcousticReflex2000Hz}" />
                                            <ComboBox Grid.Row="20" Grid.Column="2" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=RtEarAcousticReflex4000Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=RtEarAcousticReflex4000Hz}" />
                                            <ComboBox Grid.Row="20" Grid.Column="3" Style="{StaticResource ImpedanceComboBoxStyle}"
                                                  ItemsSource="{Binding Path=LtEarAcousticReflex4000Hz, Converter={StaticResource enumToCollectionConverter}, Mode=OneTime}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Description"
                                                  SelectedValue="{Binding Path=LtEarAcousticReflex4000Hz}" />
                                        </Grid>
                                    </DockPanel>
                                </Canvas>
                                <oxy:PlotView Name="ImpedancePlot" DockPanel.Dock="Top" Margin="470,10,70,10" Height="600" Width="800" VerticalAlignment="Top"
                                              HorizontalAlignment="Left" IsEnabled="{Binding ElementName=isImpedanceTestConducted, Path=IsChecked}" 
                                              Model="{Binding Tympanogram}" />
                            </DockPanel>
                        </GroupBox>
                    </AdornerDecorator>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="Bithermal Caloric">
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" IsTabStop="True">
                    <AdornerDecorator>
                        <GroupBox Name="CaloricGrpBox" Header="Bithermal Caloric Test" DockPanel.Dock="Left" 
                                      BorderBrush="CornflowerBlue" Background="AliceBlue"  Margin="5"  Padding="5">
                            <DockPanel>
                                <Canvas Name="BithermalCaloricCanvas" DockPanel.Dock="Top" HorizontalAlignment="Stretch">
                                    <DockPanel>
                                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5" HorizontalAlignment="Left">
                                            <CheckBox x:Name="isCaloricTestConducted" Content="Test conducted" Margin="0,5,20,5" 
                                                  IsChecked="{Binding IsCaloricTestConducted}" />
                                            <wpfTool:DateTimePicker Name="dtCaloricDateTime" DisplayDefaultValueOnEmptyText="True" 
                                                                DefaultValue="{x:Static sys:DateTime.Now}" Margin="10,5,5,5"  Width="300" TextAlignment="Left"
                                                                Value="{Binding ElementName=dtExamDateTime, Path=Value}" 
                                                                IsEnabled="{Binding ElementName=isCaloricTestConducted, Path=IsChecked}" />
                                        </StackPanel>
                                        <Grid DockPanel.Dock="Top" IsEnabled="{Binding ElementName=isCaloricTestConducted, Path=IsChecked}" Margin="10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left"
                                                IsEnabled="{Binding ElementName=isCaloricTestConducted, Path=IsChecked}">
                                                <RadioButton Content="Air" IsChecked="{Binding IsAirTest}" />
                                                <RadioButton Content="Water" IsChecked="{Binding IsWaterTest}" />
                                            </StackPanel>
                                            <StackPanel Grid.Row="1" Orientation="Vertical" HorizontalAlignment="Left" 
                                                        IsEnabled="{Binding ElementName=isCaloricTestConducted, Path=IsChecked}">
                                                <Grid Margin="10">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <Label Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="2" HorizontalAlignment="Center" Content="Nystagmus Starts" Margin="10,0,20,0" />
                                                    <Label Grid.Row="0" Grid.Column="4" Grid.ColumnSpan="2" HorizontalAlignment="Center" Content="Nystagmus Ends" Margin="20,0,10,0" />
                                                    <Separator Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="6" />
                                                    <Label Grid.Row="2" Grid.Column="2" HorizontalAlignment="Center" Content="min" />
                                                    <Label Grid.Row="2" Grid.Column="3" HorizontalAlignment="Center" Content="sec" />
                                                    <Label Grid.Row="2" Grid.Column="4" HorizontalAlignment="Center" Content="min" />
                                                    <Label Grid.Row="2" Grid.Column="5" HorizontalAlignment="Center" Content="sec" />
                                                    <Label Grid.Row="3" Grid.Column="1" Content="Right Ear" />
                                                    <TextBlock Grid.Row="3" Grid.Column="0" Grid.RowSpan="2" VerticalAlignment="Center" Margin="4">30<Run FontSize="10" BaselineAlignment="Superscript">o</Run>C</TextBlock>
                                                    <Label Grid.Row="4" Grid.Column="1" Content="Left Ear" />
                                                    <Separator Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="6" />
                                                    <TextBlock Grid.Row="6" Grid.Column="0" Grid.RowSpan="2" VerticalAlignment="Center" Margin="4">44<Run FontSize="10" BaselineAlignment="Superscript">o</Run>C</TextBlock>
                                                    <Label Grid.Row="6" Grid.Column="1" Content="Right Ear" />
                                                    <Label Grid.Row="7" Grid.Column="1" Content="Left Ear" />
                                                    <Separator Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="6" />
                                                    <TextBox Grid.Row="3" Grid.Column="2" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartMin30RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="3" Grid.Column="3" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartSec30RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="3" Grid.Column="4" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndMin30RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="3" Grid.Column="5" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndSec30RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="4" Grid.Column="2" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartMin30LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="4" Grid.Column="3" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartSec30LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="4" Grid.Column="4" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndMin30LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="4" Grid.Column="5" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndSec30LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="6" Grid.Column="2" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartMin44RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="6" Grid.Column="3" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartSec44RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="6" Grid.Column="4" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndMin44RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="6" Grid.Column="5" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndSec44RtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="7" Grid.Column="2" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartMin44LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="7" Grid.Column="3" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysStartSec44LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="7" Grid.Column="4" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndMin44LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeMinValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                    <TextBox Grid.Row="7" Grid.Column="5" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="NysEndSec44LtEar" UpdateSourceTrigger="LostFocus">
                                                                <Binding.ValidationRules>
                                                                    <valid:CaloricTimeSecValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:StringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                    </TextBox>
                                                </Grid>
                                                <Grid Margin="10">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <Label Grid.Row="0" Grid.Column="0" Content="Canal Paresis (%) = &#xA; [(R44+R30)-(L44+L30)]/[R44+L44+R30+L30] x 100" />
                                                    <TextBox Grid.Row="0" Grid.Column="1" IsReadOnly="True" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="CanalParesis">
                                                                <Binding.ValidationRules>
                                                                    <valid:PercentageValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:FormattedStringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="GotFocus">
                                                                <i:InvokeCommandAction Command="{Binding CanalParesisCommand}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </TextBox>
                                                    <Label Grid.Row="0" Grid.Column="2" Content="%" VerticalAlignment="Center" />
                                                    <Label Grid.Row="1" Grid.Column="0" Content="Directional Preponderance (%) = &#xA; [(R44+L30)-(L44+R30)]/[R44+L44+R30+L30] x 100" />
                                                    <TextBox Grid.Row="1" Grid.Column="1" IsReadOnly="True" Style="{StaticResource CaloricTextBoxStyle}">
                                                        <TextBox.Text>
                                                            <Binding Path="DirPrepond">
                                                                <Binding.ValidationRules>
                                                                    <valid:PercentageValidation />
                                                                </Binding.ValidationRules>
                                                                <Binding.Converter>
                                                                    <converter:FormattedStringToNullableDoubleConverter/>
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </TextBox.Text>
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="GotFocus">
                                                                <i:InvokeCommandAction Command="{Binding DirPrepondCommand}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </TextBox>
                                                    <Label Grid.Row="1" Grid.Column="2" Content="%" VerticalAlignment="Center" />
                                                </Grid>
                                                <Separator/>
                                            </StackPanel>
                                        </Grid>                                       
                                    </DockPanel>
                                </Canvas>
                                <Grid DockPanel.Dock="Top" Margin="470,10,70,10" Height="600" Width="800" VerticalAlignment="Top" HorizontalAlignment="Left"
                                      IsEnabled="{Binding ElementName=isCaloricTestConducted, Path=IsChecked}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <oxy:PlotView Grid.Row="0" Name="BithermalCaloricPlot" Height="250" Width="750" Margin="10"
                                                  HorizontalAlignment="Left" VerticalAlignment="Top" IsEnabled="{Binding ElementName=isCaloricTestConducted, Path=IsChecked}"
                                                  Model="{Binding Calorigram30}" />
                                    <oxy:PlotView Grid.Row="1" Height="250" Width="750" Margin="10" HorizontalAlignment="Left" VerticalAlignment="Top"
                                                  IsEnabled="{Binding ElementName=isCaloricTestConducted, Path=IsChecked}" Model="{Binding Calorigram44}" />
                                </Grid>
                            </DockPanel>
                        </GroupBox>
                    </AdornerDecorator>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
